package vn.edu.iuh.fit.config;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.security.config.annotation.web.builders.HttpSecurity;import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;import org.springframework.security.config.http.SessionCreationPolicy;import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;import org.springframework.security.crypto.password.PasswordEncoder;import org.springframework.security.web.SecurityFilterChain;import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;import org.springframework.web.cors.CorsConfiguration;import org.springframework.web.cors.CorsConfigurationSource;import org.springframework.web.cors.UrlBasedCorsConfigurationSource;import org.springframework.web.servlet.config.annotation.CorsRegistry;import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;import vn.edu.iuh.fit.service.token.JwtAuthenticationFilter;import java.util.Arrays;import java.util.Collections;@Configuration@EnableWebSecuritypublic class SecurityConfig {    @Autowired    private JwtAuthenticationFilter jwtAuthFilter;    @Bean    public PasswordEncoder passwordEncoder() {        return new BCryptPasswordEncoder();    }    @Bean    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {        http                .cors(cors -> cors.configurationSource(corsConfigurationSource()))                .csrf(csrf -> csrf.disable())                .authorizeHttpRequests(authz -> authz                        .requestMatchers(                                "/api/**",                                "/ws/**",                                "/swagger-ui/**",                                "/v3/api-docs/**",                                "/swagger-resources/**",                                "/webjars/**"                        ).permitAll()                        .anyRequest().authenticated()                )                .sessionManagement(session -> session                        .sessionCreationPolicy(SessionCreationPolicy.STATELESS)                )                .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class);        return http.build();    }    @Bean    public CorsConfigurationSource corsConfigurationSource() {        CorsConfiguration configuration = new CorsConfiguration();        configuration.setAllowedOrigins(Arrays.asList(                "https://two2-webtour.onrender.com",                "http://localhost:10000",                "https://a9ba-1-54-116-255.ngrok-free.app"        ));        configuration.setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"));        configuration.setAllowedHeaders(Arrays.asList(                "Authorization",                "Cache-Control",                "Content-Type",                "Accept",                "X-Requested-With",                "Access-Control-Allow-Origin",                "Access-Control-Allow-Headers",                "Origin"        ));        configuration.setAllowCredentials(true);        configuration.setExposedHeaders(Arrays.asList(                "Access-Control-Allow-Origin",                "Access-Control-Allow-Credentials",                "Authorization",                "Set-Cookie"        ));        configuration.setMaxAge(3600L);        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();        source.registerCorsConfiguration("/**", configuration);        return source;    }}